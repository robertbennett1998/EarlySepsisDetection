\begin{enumerate}
	\item Select all patients that visited the ICU.
	\item Remove all patients under 18.
\end{enumerate}

1)
\begin{lstlisting}
WITH micu_patients AS
(
    SELECT p.subject_id, p.dob, icu.dbsource, d.icd9_code, d.seq_num, icu.icustay_id, icu.los
    FROM mimiciii.patients p
    INNER JOIN mimiciii.icustays icu
    ON p.subject_id = icu.subject_id
    INNER JOIN  mimiciii.diagnoses_icd d
    ON icu.subject_id = d.subject_id
    GROUP BY p.subject_id, p.dob, icu.dbsource, d.icd9_code, d.seq_num, icu.icustay_id, icu.los
    ORDER BY  icu.icustay_id
)
\end{lstlisting}

2)
Proving interesting, DoB seem to be invalid format... also currently ~2000 people that are 300 years old:
\begin{lstlisting}
SELECT subject_id, age_at_admision, dob
FROM ages_at_admission
WHERE age_at_admision = 300
GROUP BY subject_id, age_at_admision, dob
ORDER BY age_at_admision

              subject_id    age_at_admision        dob
0             19            300.0                  1808-08-05
1             30            300.0                  1872-10-14
2             34            300.0                  1886-07-18
3             56            300.0                  1804-01-02
4            112            300.0                  1894-06-13
 ...         ...              ...                         ...
1986       99333            300.0                  1825-02-11
1987       99441            300.0                  1801-07-17
1988       99483            300.0                  1884-01-11
1989       99635            300.0                  1844-03-25
1990       99936            300.0                  1882-10-10

[1991 rows x 3 columns]
\end{lstlisting}

But none over 100 that aren't 300:
\begin{lstlisting}
SELECT subject_id, age_at_admision, dob
FROM ages_at_admission
WHERE age_at_admision > 100 AND NOT age_at_admision = 300 
GROUP BY subject_id, age_at_admision, dob
ORDER BY age_at_admision
Empty DataFrame
Columns: [subject_id, age_at_admision, dob]
Index: []
\end{lstlisting}

This is because the dates have been shifted to protect patient confidentiality. While the dates are randomly shifted they are consistent and therefore the patients age can be calculated. Patients who are older then 89 will have a calculated age of 300. https://mimic.physionet.org/mimicdata/time/